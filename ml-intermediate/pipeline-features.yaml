- source: tasks.features.sepal_area
  product: "output/{{ 'sample' if sample else 'full' }}/sepal_area.parquet"

- source: tasks.features.petal_area
  product: "output/{{ 'sample' if sample else 'full' }}/petal_area.parquet"

- source: tasks.join.fn
  name: join
  product: "output/{{ 'sample' if sample else 'full' }}/join.parquet"
  # use the on_finish key to run a function upon successful task execution.
  # this is handy for pipeline integration testing:
  # https://ploomber.readthedocs.io/en/stable/user-guide/testing.html
  on_finish: integration_tests.no_missing_values